<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dropbox File Uploader/Downloader</title>
</head>
<body>
    <h1>Dropbox File Uploader/Downloader</h1>

    <!-- Input để tải lên tệp -->
    <input type="file" id="fileInput">
    <button onclick="uploadFile()">Tải lên</button>

    <!-- Danh sách các tệp trên Dropbox -->
    <h2>Danh sách tệp trên Dropbox:</h2>
    <ul id="fileList"></ul>

    <!-- Kết quả tải tệp -->
    <h2>Kết quả tải tệp:</h2>
    <pre id="uploadResult"></pre>

    <!-- Kết quả tải tệp -->
    <h2>Kết quả tải tệp:</h2>
    <pre id="downloadResult"></pre>

    <script>
        const ACCESS_TOKEN = 'YOUR_ACCESS_TOKEN'; // Thay bằng access token bạn đã tạo trên Dropbox Developer Console

        const fileInput = document.getElementById('fileInput');
        const fileList = document.getElementById('fileList');
        const uploadResult = document.getElementById('uploadResult');
        const downloadResult = document.getElementById('downloadResult');

        // Hàm tải tệp lên Dropbox
        async function uploadFile() {
            const file = fileInput.files[0];
            if (!file) return;

            try {
                const response = await fetch(`https://content.dropboxapi.com/2/files/upload`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${ACCESS_TOKEN}`,
                        'Content-Type': 'application/octet-stream',
                        'Dropbox-API-Arg': JSON.stringify({
                            path: `/${file.name}`,
                            mode: 'add',
                            autorename: true,
                            mute: false
                        })
                    },
                    body: file
                });

                const data = await response.json();
                uploadResult.textContent = JSON.stringify(data, null, 2);
            } catch (error) {
                console.error(error);
            }
        }

        // Hàm lấy danh sách các tệp trên Dropbox
        async function listFiles() {
            try {
                const response = await fetch(`https://api.dropboxapi.com/2/files/list_folder`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${ACCESS_TOKEN}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        path: '',
                        recursive: false,
                        include_media_info: false,
                        include_deleted: false,
                        include_has_explicit_shared_members: false,
                        include_mounted_folders: true
                    })
                });

                const data = await response.json();
                const files = data.entries;
                fileList.innerHTML = '';

                files.forEach(file => {
                    const listItem = document.createElement('li');
                    listItem.textContent = file.name;
                    fileList.appendChild(listItem);
                });
            } catch (error) {
                console.error(error);
            }
        }

        listFiles();
    </script>
</body>
</html>
